<!doctype html>
<html lang="en">
    <head>

    </head>
    <body>
        <h1>Map Me</h1>
        <div id="future"></div>
        <form id="form" id="chat_form">
            <input type="submit" value="Map It!">
        </form>
         <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="/socket.io/socket.io.js"></script>

        <script>
          var ipAddress = '';

          $.get("https://ipinfo.io", function(response) {
            alert(response.ip);
            ipAddress = response.ip;
          }, "jsonp");

          var connected = false;
          var socket = io.connect('https://pulse-mapper.herokuapp.com:'+ (location.port || '443'));
          var mapData = function(data){
            socket.emit('map', data);
          };

          var onConnect = function(data){
            alert("Connection approved");
            connected = true;
          }

          socket.on('connect', onConnect);

          $('form').submit(function(e){
            e.preventDefault();
            mapData(ipAddress);
          });

        </script>
    </body>
</html>
